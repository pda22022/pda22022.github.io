<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <title>Το Άγριο Κυνήγι</title>
    <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.5.4/dist/aframe-extras.min.js"></script>
    <script>
        AFRAME.registerComponent('testing', {
            init: function () {
                this.el.addEventListener('click', e => {
                    this.el.setAttribute('animation-mixer', { timeScale: 1 });
                });
            }
        });
    </script>

    <style> 
        h1 { text-align: center; }
        h3 { text-align: center; }
        a-scene { width: 50%; height: 50%; border: dotted red 3px; }
    </style>
</head>

<body>
    <h1>ΤΟ ΑΓΡΙΟ ΚΙΝΗΓΙ</h1>
    <h3>Βασιλης Δανηλατος</h3>
    <hr />
    <p><strong>Σενάριο:</strong>...</p>
    <hr />
    <div align="center">
        <a-scene id="s1" cursor="rayOrigin: mouse" background="color:PowderBlue" ondblclick="this.requestFullscreen();" embedded> 
            <a-camera>
                <a-cursor fuse="true" fuse-timeout="5000"></a-cursor>
            </a-camera>

            <a-sphere radius="500" position="0 5000 0" material="fog: false"></a-sphere>
            
            <a-entity position="0 250 0" light="type: directional; intensity: 0.5; castShadow: true;
                    shadowCameraBottom: -500; shadowCameraTop: 500; shadowCameraLeft: -500; shadowCameraRight: 500">
            </a-entity>

            <a-light type="ambient" intensity="0.25"></a-light>
            <a-plane color="PaleGoldenrod" static-body height="1000" width="1000" rotation="-90 0 0"></a-plane>
            
            <a-assets>
                <a-asset-item id="bank" src="western_bank.glb"></a-asset-item>
                <a-asset-item id="watertower" src="western_watertower.glb"></a-asset-item>
                <a-asset-item id="church"  src="western_church.glb"></a-asset-item>
                <a-asset-item id="tree"  src="tree.glb"></a-asset-item>
                <a-asset-item id="building" src="western_building.glb"></a-asset-item>
                <a-asset-item id="tobacco" src="western_tobacco.glb"></a-asset-item>
                <a-asset-item id="Running" src="Running.glb"></a-asset-item>
                <a-asset-item id="ancient-runner" src="https://cdn.jsdelivr.net/gh/KhronosGroup/glTF-Sample-Models/2.0/CesiumMan/glTF-Binary/CesiumMan.glb"></a-asset-item>
            </a-assets>

            <!-- Κτίρια -->
            <a-entity gltf-model="#bank" scale="2 2 2" position="-1 -0.4 -20"></a-entity>
            <a-entity gltf-model="#building" scale="50 50 50" position="-35 0.9 -20"></a-entity>
            <a-entity gltf-model="#tobacco" scale="3 3 3" position="-20 -0.2 -20" rotation="0 -90 0"></a-entity>
            <a-entity gltf-model="#watertower" scale="2 3 2" position="25 57 -20"></a-entity>
            <a-entity gltf-model="#church" scale="2 2 2" position="-60 0.9 20" rotation="0 -180 0"></a-entity>
            <a-entity gltf-model="#building" scale="50 50 50" position="-15 0.9 20" rotation="0 -180 0"></a-entity>
            <a-entity gltf-model="#building" scale="50 50 50" position="15 0.9 20" rotation="0 -180 0"></a-entity>
            <a-entity gltf-model="#building" scale="50 50 50" position="30 0.9 20" rotation="0 -180 0"></a-entity>

            <!-- Χαρακτήρας που τρέχει και κινείται στον χώρο -->
            <a-entity id="runner"
                      gltf-model="#Running"
                      position="0 0 -5"
                      scale="0.3 0.3 0.3"
                      animation-mixer="clip: *; loop: repeat"
                      testing
                      animation__1="property: position; to: 0 0 -15; dur: 4000; easing: linear"
                      animation__2="property: rotation; to: 0 90 0; dur: 500; delay: 4000; easing: linear"
                      animation__3="property: position; to: 10 0 -15; dur: 4000; delay: 4500; easing: linear"
                      animation__4="property: rotation; to: 0 180 0; dur: 500; delay: 8500; easing: linear"
                      animation__5="property: position; to: 10 0 -5; dur: 4000; delay: 9000; easing: linear"
                      animation__6="property: rotation; to: 0 270 0; dur: 500; delay: 13000; easing: linear"
                      animation__7="property: position; to: 0 0 -5; dur: 4000; delay: 13500; easing: linear"
                      animation__8="property: rotation; to: 0 360 0; dur: 500; delay: 17500; easing: linear"
                      >
            </a-entity>

        </a-scene>
    </div>

    <!-- Δέντρα -->
    <script>
        const scene1 = document.getElementById('s1');
        const treeCount = 40;
        const innerRadius = 60;
        const outerRadius = 80;

        for (let i = 0; i < treeCount; i++) {
            const tree = document.createElement('a-entity');
            const angle = Math.random() * 2 * Math.PI;
            const radius = innerRadius + Math.random() * (outerRadius - innerRadius);
            const x = Math.cos(angle) * radius;
            const z = Math.sin(angle) * radius;
            const s = 0.1;
            const r = Math.random() * 180 - 90;

            tree.setAttribute('gltf-model', '#tree');
            tree.setAttribute('position', `${x} 0 ${z}`);
            tree.setAttribute('scale', `${s} ${s} ${s}`);
            tree.setAttribute('rotation', `0 ${r} 0`);
            tree.setAttribute('shadow', 'receive: false');

            scene1.appendChild(tree);
        }
    </script>

    <hr />
    <p><strong>Οδηγίες:</strong> Κάνε κλικ στον χαρακτήρα για να αρχίσει να κινείται.</p>
    <hr />
    <p><strong>Credits:</strong></p>      
</body>
</html>
