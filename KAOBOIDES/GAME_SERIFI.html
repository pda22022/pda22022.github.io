<html>
<head>
  <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.5.4/dist/aframe-extras.min.js"></script>

  <style>
    body { margin: 0; }
    h1, h3 { text-align: center; }
    a-scene { width: 100%; height: 90vh; border: dotted red 2px; }
  </style>

  <script>
    // Component: laser shooting logic
    AFRAME.registerComponent('shooter', {
      init: function () {
        const scene = this.el;
        const camera = document.querySelector('[camera]');
        const cursor = document.querySelector('#cursor');

        cursor.addEventListener('click', function () {
          const targets = document.querySelectorAll('.target');

          targets.forEach(target => {
            const intersection = cursor.components.raycaster.getIntersection(target);
            if (intersection) {
              // Trigger fall animation
              target.emit('shoot');

              // Create yellow laser beam (thin box)
              const laser = document.createElement('a-box');
              laser.setAttribute('position', '0 1.6 0');
              laser.setAttribute('depth', '0.1');
              laser.setAttribute('height', '0.05');
              laser.setAttribute('width', '5');
              laser.setAttribute('color', 'yellow');
              laser.setAttribute('rotation', '0 0 0');
              scene.appendChild(laser);

              // Remove laser after 2 seconds
              setTimeout(() => scene.removeChild(laser), 2000);
            }
          });
        });
      }
    });
  </script>
</head>

<body>
  <h1>ΤΙΤΛΟΣ ΕΡΓΑΣΙΑΣ</h1>
  <h3>Ονοματεπώνυμο</h3>
  <hr />
  <p><strong>Σενάριο:</strong> Πυροβολείς τον εχθρό με κλικ.</p>
  <hr />

  <a-scene shooter cursor="rayOrigin: mouse" embedded background="color:SkyBlue" ondblclick="this.requestFullscreen();">
    
    <!-- Camera & Cursor -->
    <a-camera>
      <a-cursor id="cursor" raycaster="objects: .target" material="color: yellow;"></a-cursor>
    </a-camera>

    <!-- Lighting -->
    <a-entity light="type: directional; intensity: 0.6;" position="0 5 5"></a-entity>
    <a-entity light="type: ambient; intensity: 0.3;"></a-entity>

    <!-- Ground -->
    <a-plane rotation="-90 0 0" width="100" height="100" color="#deb887"></a-plane>

    <!-- Assets -->
    <a-assets>
      <!-- Αυτό είναι το μοντέλο που έχει μετατραπεί από Sneak Walk.fbx σε glb -->
      <a-asset-item id="sneakwalk" src="sneak-walk.glb"></a-asset-item>
    </a-assets>

    <!-- Cowboy εχθρός με κινούμενο animation -->
    <a-entity id="enemy"
              class="target"
              gltf-model="#sneakwalk"
              position="0 0 -5"
              scale="1 1 1"
              animation-mixer="clip: *"
              animation="property: rotation; to: 90 0 0; dur: 1000; startEvents: shoot">
    </a-entity>

  </a-scene>

  <hr />
  <p><strong>Οδηγίες:</strong> Πάτησε click πάνω στον cowboy για να τον "πυροβολήσεις". Θα δεις μια κίτρινη γραμμή (laser) και αυτός θα πέσει κάτω.</p>
</body>
</html>
